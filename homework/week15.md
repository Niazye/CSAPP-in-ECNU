# Homework Week14

## 9.11

虚拟地址 `0x027c`

A. 虚拟地址格式

| 13  | 12  | 11  | 10  | 9   | 8   | 7   | 6   | 5   | 4   | 3   | 2   | 1   | 0   |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| 0   | 0   | 0   | 0   | 1   | 0   | 0   | 1   | 1   | 1   | 1   | 1   | 0   | 0   |

B. 地址翻译

| 参数      | 值         |
| --------- | ---------- |
| VPN       | 9          |
| TLB索引   | 1          |
| TLB标记   | 2          |
| TLB命中？ | 否         |
| 缺页？    | 否         |
| PPN       | 0x17 == 23 |

C. 物理地址格式

| 11  | 10  | 9   | 8   | 7   | 6   | 5   | 4   | 3   | 2   | 1   | 0   |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| 0   | 1   | 0   | 1   | 1   | 1   | 1   | 1   | 1   | 1   | 0   | 0   |

D. 物理地址引用

| 参数             | 值  |
| ---------------- | --- |
| 字节偏移         | 0   |
| 缓存索引         | 15  |
| 缓存标记         | 23  |
| 缓存命中？       | 否  |
| 返回的缓存字节？ | -   |

## 9.12

虚拟地址 `0x03a9`

A. 虚拟地址格式

| 13  | 12  | 11  | 10  | 9   | 8   | 7   | 6   | 5   | 4   | 3   | 2   | 1   | 0   |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| 0   | 0   | 0   | 0   | 1   | 1   | 1   | 0   | 1   | 0   | 1   | 0   | 0   | 1   |

B. 地址翻译

| 参数      | 值         |
| --------- | ---------- |
| VPN       | 14         |
| TLB索引   | 2          |
| TLB标记   | 3          |
| TLB命中？ | 否         |
| 缺页？    | 否         |
| PPN       | 0x11 == 17 |

C. 物理地址格式

| 11  | 10  | 9   | 8   | 7   | 6   | 5   | 4   | 3   | 2   | 1   | 0   |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| 0   | 1   | 0   | 0   | 0   | 1   | 1   | 0   | 1   | 0   | 0   | 1   |

D. 物理地址引用

| 参数             | 值  |
| ---------------- | --- |
| 字节偏移         | 1   |
| 缓存索引         | 10  |
| 缓存标记         | 17  |
| 缓存命中？       | 否  |
| 返回的缓存字节？ | -   |

## 9.13

虚拟地址 `0x0040`

A. 虚拟地址格式

| 13  | 12  | 11  | 10  | 9   | 8   | 7   | 6   | 5   | 4   | 3   | 2   | 1   | 0   |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| 0   | 0   | 0   | 0   | 0   | 0   | 0   | 1   | 0   | 0   | 0   | 0   | 0   | 0   |

B. 地址翻译

| 参数      | 值  |
| --------- | --- |
| VPN       | 1   |
| TLB索引   | 1   |
| TLB标记   | 0   |
| TLB命中？ | 否  |
| 缺页？    | 是  |
| PPN       | -   |

C. 物理地址格式

| 11  | 10  | 9   | 8   | 7   | 6   | 5   | 4   | 3   | 2   | 1   | 0   |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
|     |     |     |     |     |     |     |     |     |     |     |     |

D. 物理地址引用

| 参数             | 值  |
| ---------------- | --- |
| 字节偏移         |     |
| 缓存索引         |     |
| 缓存标记         |     |
| 缓存命中？       |     |
| 返回的缓存字节？ |     |

## 9.14

```c
#include <sys/mman.h>
#include <fcntl.h>
#include <stdio.h>

int main() {
    int f;
    char *mmapped;
    f = open("hello.txt", O_RDWR);
    mmapped = (char *)mmap(NULL, 10, PROT_WRITE, MAP_SHARED, f, 0);
    mmapped[0] = 'J';
    munmap(mmapped, 10);
    close(f);
    
    return 0;
}
```