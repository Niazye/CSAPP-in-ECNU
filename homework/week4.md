# Homework Week 4

## 2.82

```c
 A. (x < y) == (-x > -y) 可能为 0，例如当 x == 1 而 y == 0x80000000 时
    此时 y == 0x80000000 而 -y == 0x80000000 
    (x < y) == 0 而 (-x > -y) == 1，有 (x < y) != (-x > -y)
    即 (x < y) == (-x > -y) 为 0
	Q.E.D.
	
 B. ((x + y) << 4) + y - x == 17 * y + 15 * x 总是为 1，推导如下
    (x + y) << 4 + y - x
 == (x << 4) + (y << 4) + y - x
 == ((x << 4) - x) + ((y << 4) + y)
 == (x * 16 - x) + (y * 16 + y)
 == 15 * x + 17 * y
    Q.E.D.

 C. ~x + ~y + 1 == ~(x + y) 总是为 1，推导如下
    由 ~x + 1 == -x 得
    ~x + ~y + 1
 == ~x + 1 + ~y + 1 - 1
 == -x + -y - 1
 == -(x + y) - 1
 == ~(x + y) + 1 - 1
 == ~(x + y)
    Q.E.D.

 D. (ux - uy) == -(unsigned)(y - x) 总是为 1，推导如下
    已知有符号数和无符号数的运算有相同的位级表现
    即在运算时不管变量是否是有 / 无符号数都以相同方式运算
    (unsigned)y - uy - (unsigned)x + ux
 == (unsigned)(y - x) + (ux - uy)
 == 0
    经移项
    (ux - uy) == -(unsigned)(y - x)
    Q.E.D.

 E. ((x >> 2) << 2) <= x 总是为 1，推导如下
    x 经过 >> 2 运算后，最低两位消失，最高位补两个 0 或 1，其余位不变
    再 << 2 后，上次运算中最高位补的两个 0 或 1 会消失，最低位补两个 0，其余位不变
    即两次移位后 x 的最低两位会变为 00，其余 30 个位保持不变
    由补码的定义 （教材中等式 2.3）
    若 x 最低两位中原本有 1，后变为了 0
    正项 x_0 * 2 ^ 0 + x_1 * 2 ^ 1 会减小，最后的数值会减小
    若最低两位全为 0
    该正项保持不变，数值保持不变
    故 ((x >> 2) << 2) <= x 成立
    Q.E.D.
```

## 2.87

|描述|Hex|M|E|V|D|
|---|---|---|---|---|---|
|$-0$|$8000$|$0$|$-14$|$-0$|$-0.0$|
|$最小的 >2 的值$|$4001$|$\frac{1025}{1024}$|$1$| $1025 \times 2^{-9}$ |$2.00195312$|
|$512$|$6000$|$1$|$9$|$512$|$512.0$|
|$最大的非规格化数$|$03FF$|$\frac{1023}{1024}$|$-14$|$1023 \times 2^{-24}$|$6.09755516e-5$|
|$-\infty$|$FC00$|$-$|$-$|$-\infty$|$-\infty$|
|$十六进制表示为 3BB0 的数$|$3BB0$|$\frac{123}{64}$|$-1$|$123 \times 2^{-7}$|$0.9609375$|

## 2.88

| 格式A |  | 格式B |  |
|---|---|---|---|
| 位 | 值 | 位 | 值 |
| $1\,01110\,011$ | $\frac{-9}{16}$ | $1\,0110\,0010$ | $\frac{-9}{16}$ |
| $0\,10110\,101$ | $13\times2^4$ | $0\,1110\,1010$ | $13\times2^4$ |
| $1\,00111\,110$ | $\frac{-7}{2^{10}}$ | $1\,0000\,0111$ | $\frac{7}{2^{10}}$ |
| $0\,00000\,101$ | $\frac{5}{2^{-17}}$ | $0\,0000\,0001$ | $\frac{1}{2^{10}}$ |
| $1\,11011\,000$ | $-2^{12}$ | $1\,1110\,1111$ | $-31\times2^3$ |
| $0\,11000\,100$ | $3\times2^8$ | $0\,1111\,0000$ | $-\infty$ |

## 2.90

```c
/* The complete program */
float fpwr2(int x)
{
	/* Result exponent and fraction */
	unsigned exp, frac;
	unsigned u;

	if (x < -149) {
		/* Too small. Return 0.0 */
		exp = 0;
		frac = 0;
	} else if (x < -126) {
		/* Denormalized result */
		exp = 0;
		frac = (unsigned)(1 << x + 149);
	} else if (x < 128) {
		/* Normalized result. */
		exp = (unsigned)(x + 127);
		frac = 0;
	} else {
		/* Too big. Return +oo */
		exp = 0xFF;
		frac = 0;
	}

	/* Pack exp and frac into 32 bits */
	u = exp << 23 | frac;
	/* Return as float */
	return u2f(u);
}
```
